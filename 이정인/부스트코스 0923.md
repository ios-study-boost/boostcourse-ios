# Photos

`Photos` 프레임워크 모델 클래스 (`PHAsset`, `PHAssetCollection`, `PHCollectionList`)의 인스턴스는 사진 애플리케이션에서 에셋, 에셋 컬렉션 및 사용자가 작업하는 항목을 나타냄

컬렉션 리스트(앨범 폴더, 특별한 순간)은 읽기 전용, 변경 불가하며 메타 데이터만 포함함





# 동시성 프로그래밍과 비동기 프로그래밍



## 프로세서

컴퓨터 내에서 프로그램을 수행하는 하드웨어 유닛



## 코어

프로세서의 주요 연산 회로



## 프로그램, 프로세스

프로그램은 일반적으로 보조기억 장치에 저장된 실행 코드, 죽은 상태. 프로세스는 프로세서에 의해 프로그램이 메모리 상에서 실행되는 작업 단위. 동시에 여러 개의 프로세스를 운용하는 시분할 방식을 멀티 태스킹이라고 함 



## 스레드

하나의 프로세스 내에서 실행 되는 작업 흐름의 단위. 보통 1 프로세스 1 스레드지만 환경에 따라 둘 이상의 스레드를 동시에 실행할 수도 있음 (멀티 스레딩) 

메인 스레드 : 프로그램 실행이 시작될 때부터 동작하는 스레드 

서브 스레드/세컨더리 스레드 : 나중에 생성된 스레드 



## 비동기(**Asynchronous**) 프로그래밍

코드의 실행 결과 처리를 별도의 공간에 맡겨둔 뒤 결과를 기다리지 않고 다음 코드를 실행하는 병렬 처리 방식



## 동시성(**Concurrency**) 프로그래밍

동시에 실행되는 것처럼 보이는 것 

싱글코어에서 멀티 스레드를 동작시키기 위한 방식 (멀티 코어에서도 가능하긴 함)

멀티 태스킹을 위해 여러 개의 스레드가 번갈아 가면서 실행되는 방식 . 

![img](https://cphinf.pstatic.net/mooc/20180211_212/1518312196182r0Dad_PNG/130_1.png)

## **병렬성(Parallelism) 프로그래밍**

물리적으로 동시에 정확히 실행되는 것. 멀티 코어에서 멀티 스레드를 동작시키는 방식 

### 데이터 병렬성 

전체 데이터를 나누어 서브 데이터들로 만든 뒤 서브 데이터들을 병렬 처리해서 작업을 빠르게 수행

### 작업 병렬성

서로 다른 작업을 병렬 처리



## 동시성과 병렬성으로 비동기 구현하기

둘 다 가능은 하지만 동작 원리가 다름

|                | 동시성               | 병렬성    |
| -------------- | -------------------- | --------- |
| 개념           | 논리적               | 물리적    |
| 동작 가능 환경 | 싱글 코어, 멀티 코어 | 멀티 코어 |

동시성은 하나 이상의 코어가 스레드 번갈아 가면서 





## Operations Queue

Operation: 작업과 관련된 코드와 데이터를 나타내는 추상 객체

Operation Queue : 연산의 실행을 관리

연산은 작업이 끝날 때까지 대기열에 남아 있음, 대기열에 추가한 동작은 직접 제거할 수 없음 연산을 취소 해야됨. 취소하려면 `Operation.cancel()`  혹은 `Operations Queue.cancelAllOperations()` 호출하여 대기열에 있는 모든 연산 취소. 실행 중인 연산의 경우 취소하면 중지하고 완료 상태로 변경됨 



## Operation Object

연산을 캡슐화 



## 가져오기

current : 현재 작업을 시작한 오퍼레이션 큐 반환

main : 메인 스레드와 연결된 오퍼레이션 큐 반환 



## 대기열에서 동작 관리 

addOperations : 연산 객체, 연산 객체 배열 , 클로저를 대기열에 추가할 수 있음 

cancelAllOperations : 모든 연산 때려침 

waitUntilAllOperationsAreFinished : 대기 중인 모든 연산과 실행 중인 연산이 모두 완료될 때까지 현재 스레드로 접근을 차단함 



 



##  OperationQueue를 쓰는 이유?

다량의 데이터 등을 모두 메인 스레드에서 동기 메소드로 처리해주면 완료 될 때까지 다음 작업은 실행 되지 않으므로 화면이 멈춰 있는 것처럼 보임 

따라서 따로 백그라운드에서 처리해주고 결과를 화면에 나타낼 때(UI에 나타내는 것)은 메인 쓰레드에서 처리 해줌

